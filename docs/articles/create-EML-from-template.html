<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Create EML from Template â€¢ EMLaide</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Create EML from Template">
<meta property="og:description" content="EMLaide">
<meta property="og:image" content="https://CVPIA-OSC.github.io/EMLaide/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EMLaide</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/template-doc.html">Metadata Template Documentation</a>
    </li>
    <li>
      <a href="../articles/create-EML-from-template.html">Create EML Document from Template</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/CVPIA-OSC/EMLaide">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="create-EML-from-template_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Create EML from Template</h1>
            
      
      
      <div class="hidden name"><code>create-EML-from-template.Rmd</code></div>

    </div>

    
    
<p>This document walks through the creation of an EML document based on example data and metadata.</p>
<p>The following libraries are needed to create a working EML document.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://CVPIA-OSC.github.io/EMLaide/">EMLaide</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/EDIorg/EDIutils">EDIutils</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/EML/">EML</a></span><span class="op">)</span></code></pre></div>
<div id="ecological-metadata-languageeml-schema-outline" class="section level2">
<h2 class="hasAnchor">
<a href="#ecological-metadata-languageeml-schema-outline" class="anchor"></a>Ecological Metadata Language(EML) Schema Outline</h2>
<p>We use the EML package to generate the EML document based on our metadata inputs. The EML package <code><a href="https://docs.ropensci.org/EML/reference/write_eml.html">write_eml()</a></code> function takes in a nested list and formats the list into an EML document. To create valid EML the nested list must:</p>
<ul>
<li>Contain all required EML fields</li>
<li>nest all fields under the correct sub sections</li>
</ul>
<p>We have two main sections within our EML document:</p>
<ul>
<li>Access - The <a href="https://eml.ecoinformatics.org/schema/eml_xsd.html#eml_access">Access Section</a> defines the access for the entire resource (entire EML document)</li>
<li>Dataset - The <a href="https://eml.ecoinformatics.org/schema/eml_xsd.html#eml_dataset">Dataset Resource</a> contains the descriptive metadata information on a data set. A data set can contain one or more data entities. A data entity is a tabular data table or a vector or raster image.</li>
</ul>
<p>The Dataset element contains all of the additional metadata information. The Dataset element is composed of nested lists. Some information is at the top level and is applicable to all elements in the Dataset but other information is nested within subsections and is metadata specific to that subsection.</p>
<p>For a more in depth description of EML please see <a href="https://eml.ecoinformatics.org/">EML Specification.</a></p>
<p>In this document, we can quickly create an EML file which has the opportunity to append the following elements. For more detailed instructions on a specific section please see section specific articles.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> eml </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="at">  -access</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="at">  -dataset</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> creator</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> contact</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> associated parties</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> title  </span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> abstract </span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> keyword set  </span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> license </span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> methods </span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> maintenance </span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> project</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> coverage </span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> data table </span></span></code></pre></div>
</div>
<div id="our-example" class="section level2">
<h2 class="hasAnchor">
<a href="#our-example" class="anchor"></a>Our Example</h2>
<p>We will use the data provided by Amanda Banet to show an example of how to compile metadata in a valid EML document that can be uploaded to the EDI data portal website. To follow along with this example please download the <a href="https://cvpia-data-stewardship.s3-us-west-1.amazonaws.com/Banet-Example.zip">Banet-Example zip folder</a>.</p>
<div id="required-files" class="section level3">
<h3 class="hasAnchor">
<a href="#required-files" class="anchor"></a>Required Files</h3>
<p>At least four files must be uploaded to make a complete EML document. To follow along with this example please load the following files from the <code>Banet-Example</code> folder into your environment.</p>
<ul>
<li>
<strong>Datatable(s) and associated metadata</strong> One or more files stored in a dataframe that contains the data (preferably csv if tabular data) and associated datatable specific metadata. (see datatables and assocaited metadata section below)</li>
<li>
<strong>Data Package Metadata</strong> An excel spreadsheet containing the majority of the metadata</li>
<li>
<strong>Abstract Document</strong> A word or markdown document containing the abstract text</li>
<li>
<strong>Methods Document</strong> A word or markdown document containing the methods text</li>
</ul>
</div>
<div id="datatables-and-associated-metadata" class="section level3">
<h3 class="hasAnchor">
<a href="#datatables-and-associated-metadata" class="anchor"></a>Datatable(s) and associated metadata</h3>
<p>This section provides the actual datatables that you wish to upload to EDI and metadata describing the attributes of the datatables. The files are organized in a dataframe with each row representing a different datatable.</p>
<p>This dataframe is input to <code>add_datatable</code>. Within the <code>add_datatable</code> function we generate attribute metadata from the <code>atribute_info</code> files and physical information describing the datatable from the <code>filepath</code> and <code>datatable_url</code> information. We then combine these into a list of one or more <code>dataTable</code> elements that are appended to our <code>dataset</code> list.</p>
<p>Datatables and associated metadata should be added in a nested list or tibble that contains the following information:</p>
<ul>
<li>A <code>filepath</code> column or named list which contains the names file paths of the datatables</li>
<li>An <code>attribute_info</code> column or named list which contains the file path to the metadata describing the specific datatable (should be a metadata.xlsx)</li>
<li>A <code>datatable_description</code> column or named list that contains a brief description of datatable</li>
<li>(Optional) A <code>datattable_url</code> column or named list that provides a link to the datatables. This is optional but if you would like to evaluate or upload your EML document directly from RStudio using <code>EMLaide</code> <code><a href="../reference/evaluate_edi_package.html">evaluate_edi_package()</a></code> or <code><a href="../reference/upload_edi_package.html">upload_edi_package()</a></code> then the <code>dattable_url</code> must link to a publicly accessible file hosted online.</li>
<li>(Optional) A <code>datatable_methods</code> column or named list that reads file path to datatable specific methods</li>
<li>(Optional) An <code>additional_information</code> column or named list that adds additional information that is pertinent to the entry, please add it as a string description.</li>
</ul>
<p><strong>Example Dataframe Structure for <code>datatable_metadata</code></strong></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datatable_metadata</span> <span class="op">&lt;-</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>filepath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"data/enclosure-study-growth-rate-data.csv"</span>,
                             <span class="st">"data/enclosure-study-gut-contents-data.csv"</span>,
                             <span class="st">"data/microhabitat-use-data-2018-2020.csv"</span>,
                             <span class="st">"data/seining-weight-lengths-2018-2020.csv"</span>,
                             <span class="st">"data/snorkel-index-data-2015-2020.csv"</span><span class="op">)</span>,  
                attribute_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"metadata/enclosure-study-growth-rates-metadata.xlsx"</span>,
                                   <span class="st">"metadata/enclosure-study-gut-contents-metadata.xlsx"</span>,
                                   <span class="st">"metadata/microhabitat-use-metadata.xlsx"</span>,
                                   <span class="st">"metadata/seining-weight-length-metadata.xlsx"</span>,
                                   <span class="st">"metadata/snorkel-index-metadata.xlsx"</span><span class="op">)</span>,
                datatable_description <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Growth Rates - Enclosure Study"</span>,
                                          <span class="st">"Gut Contents - Enclosure Study"</span>,
                                          <span class="st">"Microhabitat Data"</span>,
                                          <span class="st">"Seining Weight Lengths Data"</span>,
                                          <span class="st">"Snorkel Survey Data"</span><span class="op">)</span>,
                datatable_url <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/FlowWest/edi.749.1/main/data/"</span>,
                                       <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"enclosure-study-growth-rate-data.csv"</span>,
                                         <span class="st">"enclosure-study-gut-contents-data.csv"</span>,
                                         <span class="st">"microhabitat-use-data-2018-2020.csv"</span>,
                                         <span class="st">"seining-weight-lengths-2018-2020.csv"</span>,
                                         <span class="st">"snorkel-index-data-2015-2020.csv"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The final tibble should have the same structure as our <code>datatable_metadata</code>. Each row contains all information needed on a datatable to add to the datapackage. If you only have one datatable keep this structure or use a named list with the same information.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">datatable_metadata</span><span class="op">)</span></code></pre></div>
<table class="table">
<colgroup>
<col width="18%">
<col width="22%">
<col width="13%">
<col width="44%">
</colgroup>
<thead><tr class="header">
<th align="left">filepath</th>
<th align="left">attribute_info</th>
<th align="left">datatable_description</th>
<th align="left">datatable_url</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">data/enclosure-study-growth-rate-data.csv</td>
<td align="left">metadata/enclosure-study-growth-rates-metadata.xlsx</td>
<td align="left">Growth Rates - Enclosure Study</td>
<td align="left"><a href="https://raw.githubusercontent.com/FlowWest/edi.749.1/main/data/enclosure-study-growth-rate-data.csv" class="uri">https://raw.githubusercontent.com/FlowWest/edi.749.1/main/data/enclosure-study-growth-rate-data.csv</a></td>
</tr>
<tr class="even">
<td align="left">data/enclosure-study-gut-contents-data.csv</td>
<td align="left">metadata/enclosure-study-gut-contents-metadata.xlsx</td>
<td align="left">Gut Contents - Enclosure Study</td>
<td align="left"><a href="https://raw.githubusercontent.com/FlowWest/edi.749.1/main/data/enclosure-study-gut-contents-data.csv" class="uri">https://raw.githubusercontent.com/FlowWest/edi.749.1/main/data/enclosure-study-gut-contents-data.csv</a></td>
</tr>
<tr class="odd">
<td align="left">data/microhabitat-use-data-2018-2020.csv</td>
<td align="left">metadata/microhabitat-use-metadata.xlsx</td>
<td align="left">Microhabitat Data</td>
<td align="left"><a href="https://raw.githubusercontent.com/FlowWest/edi.749.1/main/data/microhabitat-use-data-2018-2020.csv" class="uri">https://raw.githubusercontent.com/FlowWest/edi.749.1/main/data/microhabitat-use-data-2018-2020.csv</a></td>
</tr>
<tr class="even">
<td align="left">data/seining-weight-lengths-2018-2020.csv</td>
<td align="left">metadata/seining-weight-length-metadata.xlsx</td>
<td align="left">Seining Weight Lengths Data</td>
<td align="left"><a href="https://raw.githubusercontent.com/FlowWest/edi.749.1/main/data/seining-weight-lengths-2018-2020.csv" class="uri">https://raw.githubusercontent.com/FlowWest/edi.749.1/main/data/seining-weight-lengths-2018-2020.csv</a></td>
</tr>
<tr class="odd">
<td align="left">data/snorkel-index-data-2015-2020.csv</td>
<td align="left">metadata/snorkel-index-metadata.xlsx</td>
<td align="left">Snorkel Survey Data</td>
<td align="left"><a href="https://raw.githubusercontent.com/FlowWest/edi.749.1/main/data/snorkel-index-data-2015-2020.csv" class="uri">https://raw.githubusercontent.com/FlowWest/edi.749.1/main/data/snorkel-index-data-2015-2020.csv</a></td>
</tr>
</tbody>
</table>
</div>
<div id="data-package-metadata-methods-and-abstract" class="section level3">
<h3 class="hasAnchor">
<a href="#data-package-metadata-methods-and-abstract" class="anchor"></a>Data Package Metadata, Methods, and Abstract</h3>
<p>The following code block loads the <code>data-package-metadata.xlsx</code>, <code>abstrac_docs</code>, and <code>methods_docx</code>. The data package metadata excel document contains metadata that is relevant to the entire datapackge and has different sheets pertaining to different metadata elements. In the create dataset element section below the <code>add_[blank]</code> functions below will take in sheets of the <code>metadata</code> object as inputs.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">excel_path</span> <span class="op">&lt;-</span> <span class="st">"Banet-Example/metadata/data-package-metadata.xlsx"</span>
<span class="va">sheets</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/excel_sheets.html">excel_sheets</a></span><span class="op">(</span><span class="va">excel_path</span><span class="op">)</span>
<span class="va">metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">sheets</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="va">excel_path</span>, sheet <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">metadata</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">sheets</span>

<span class="va">abstract_docx</span> <span class="op">&lt;-</span> <span class="st">"metadata/abstract.docx"</span>
<span class="va">methods_docx</span> <span class="op">&lt;-</span> <span class="st">"metadata/methods.docx"</span></code></pre></div>
</div>
<div id="edi-number" class="section level3">
<h3 class="hasAnchor">
<a href="#edi-number" class="anchor"></a>EDI Number</h3>
<p>In addition to these files an EDI number must be defined. The EDI number should be a unique data package identifier. You can reserve this data package identifier number on the <a href="https://portal.edirepository.org/nis/reservations.jsp">EDI data repository under tools.</a></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">edi_number</span> <span class="op">&lt;-</span> <span class="st">"edi.750.1"</span> </code></pre></div>
<p>It is also possible to use the <code>EMLaide</code> function  to generate a EDI number without visiting the EDI website. You must already have an account associated with EDI to do this.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">edi_number</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reserve_edi_id.html">reserve_edi_id</a></span><span class="op">(</span>user_id <span class="op">=</span> <span class="st">"your user id"</span>, password <span class="op">=</span> <span class="st">"your user password "</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="create-dataset-element" class="section level2">
<h2 class="hasAnchor">
<a href="#create-dataset-element" class="anchor"></a>Create Dataset Element</h2>
<p>Beginning with an empty list, each function call appends and an EML element as a named list.</p>
<p>The <code>add_[blank]</code> functions are wrappers on <code>create_[blank]</code> function to enable a <code>%&gt;%</code> workflow.</p>
<p>For details on appropriate inputs to the functions see documentation at <code>?add_[blank]</code>.</p>
<p>The <code>add_methods()</code> and <code><a href="../reference/add_abstract.html">add_abstract()</a></code> functions take in the <code>methods_docx</code> and the <code>abstract_doc</code>. The <code><a href="../reference/add_datatable.html">add_datatable()</a></code> function takes in the <code>datatable_metadata</code> defined and described above. Every other function takes in one or more sheets from the <code>metadata</code> object. For template items with multiple rows the <code>add_[blank]</code> functions map through each row and adds a named nested list for each row to the dataset element.</p>
<p><strong>Ex:</strong> Add personnel will map through each row of <code>metadata$personnel</code> shown below and add all four personnel into the dataset element.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">metadata</span><span class="op">$</span><span class="va">personnel</span><span class="op">)</span></code></pre></div>
<table class="table">
<colgroup>
<col width="9%">
<col width="9%">
<col width="12%">
<col width="13%">
<col width="23%">
<col width="31%">
</colgroup>
<thead><tr class="header">
<th align="left">first_name</th>
<th align="left">last_name</th>
<th align="left">email</th>
<th align="left">role</th>
<th align="left">organization</th>
<th align="left">orcid</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Amanda</td>
<td align="left">Banet</td>
<td align="left"><a href="mailto:mail@mail.mail" class="email">mail@mail.mail</a></td>
<td align="left">creator</td>
<td align="left">CSU Chico</td>
<td align="left"><a href="https://orcid.org/0000-0002-6225-2057" class="uri">https://orcid.org/0000-0002-6225-2057</a></td>
</tr>
<tr class="even">
<td align="left">John</td>
<td align="left">Hannon</td>
<td align="left"><a href="mailto:mail@mail.mail" class="email">mail@mail.mail</a></td>
<td align="left">program founder</td>
<td align="left">US Bureau of Reclamation</td>
<td align="left"><a href="http://orcid.org/0000-0001-9057-9084" class="uri">http://orcid.org/0000-0001-9057-9084</a></td>
</tr>
<tr class="odd">
<td align="left">Steve</td>
<td align="left">Tussing</td>
<td align="left"><a href="mailto:mail@mail.mail" class="email">mail@mail.mail</a></td>
<td align="left">other</td>
<td align="left">Tussing Ecological Services</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">Ryan</td>
<td align="left">Greathouse</td>
<td align="left"><a href="mailto:mail@mail.mail" class="email">mail@mail.mail</a></td>
<td align="left">other</td>
<td align="left">PSMFC</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
<p>The code below adds all dataset elements to a dataset list.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/add_pub_date.html">add_pub_date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/add_title.html">add_title</a></span><span class="op">(</span><span class="va">metadata</span><span class="op">$</span><span class="va">title</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/add_personnel.html">add_personnel</a></span><span class="op">(</span><span class="va">metadata</span><span class="op">$</span><span class="va">personnel</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/add_keyword_set.html">add_keyword_set</a></span><span class="op">(</span><span class="va">metadata</span><span class="op">$</span><span class="va">keyword_set</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/add_abstract.html">add_abstract</a></span><span class="op">(</span><span class="va">abstract_docx</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/add_license.html">add_license</a></span><span class="op">(</span><span class="va">metadata</span><span class="op">$</span><span class="va">license</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/add_method.html">add_method</a></span><span class="op">(</span><span class="va">methods_docx</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/add_maintenance.html">add_maintenance</a></span><span class="op">(</span><span class="va">metadata</span><span class="op">$</span><span class="va">maintenance</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/add_project.html">add_project</a></span><span class="op">(</span><span class="va">metadata</span><span class="op">$</span><span class="va">funding</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/add_coverage.html">add_coverage</a></span><span class="op">(</span><span class="va">metadata</span><span class="op">$</span><span class="va">coverage</span>, <span class="va">metadata</span><span class="op">$</span><span class="va">taxonomic_coverage</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/add_datatable.html">add_datatable</a></span><span class="op">(</span><span class="va">datatable_metadata</span><span class="op">)</span></code></pre></div>
</div>
<div id="handle-custom-units" class="section level2">
<h2 class="hasAnchor">
<a href="#handle-custom-units" class="anchor"></a>Handle Custom Units</h2>
<p>When units arenâ€™t standard <code><a href="../reference/add_datatable.html">add_datatable()</a></code>will give a message like the following: <code>"We identified the following custom unit: fishPerSchool , please make sure to add information on this custom unit in additional metadata information:"</code>. We must formally define each of these custom units and add them to the EML document as an additional metadata section.</p>
<p>The code below defines 4 custom units and uses the <code><a href="https://docs.ropensci.org/EML/reference/set_unitList.html">EML::set_unitList()</a></code> function to format them into a unitList that can be added to our EML document.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">custom_units</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"fishPerEnclosure"</span>, <span class="st">"thermal unit"</span>, <span class="st">"day"</span>, <span class="st">"fishPerSchool"</span><span class="op">)</span>,
                           unitType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"density"</span>, <span class="st">"temperature"</span>, <span class="st">"dimensionless"</span>, <span class="st">"density"</span><span class="op">)</span>,
                           parentSI <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,
                           multiplierToSI <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,
                           description <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Fish density in the enclosure, number of fish in total enclosure space"</span>,
                                           <span class="st">"thermal unit of energy given off of fish"</span>,
                                           <span class="st">"count of number of days that go by"</span>,
                                           <span class="st">"Number of fish counted per school"</span><span class="op">)</span><span class="op">)</span>

<span class="va">unitList</span> <span class="op">&lt;-</span> <span class="fu">EML</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/EML/reference/set_unitList.html">set_unitList</a></span><span class="op">(</span><span class="va">custom_units</span><span class="op">)</span></code></pre></div>
</div>
<div id="combine-eml-elements-and-build-document" class="section level2">
<h2 class="hasAnchor">
<a href="#combine-eml-elements-and-build-document" class="anchor"></a>Combine EML Elements and Build Document</h2>
<p>The code below adds all of the elements we generated above and an access element into an <code>eml</code> list.</p>
<ul>
<li>The <code>add_access</code> adds an access section at the beginning of our EML document. The <code>add_access</code> default is public principal with a read permission.</li>
<li>The <code>dataset</code> list from above contains all elements of the <code>dataset</code> section of the EML. This includes the <code>datatables</code>, <code>abstract</code>, <code>methods</code>, and all the other metadata sections appended above.</li>
<li>The <code>addtionalMetadata</code> contains the <code>unitList</code> that we generated to hold our custom units.</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">eml</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>packageId <span class="op">=</span> <span class="va">edi_number</span>,
            system <span class="op">=</span> <span class="st">"EDI"</span>,
            access <span class="op">=</span> <span class="fu"><a href="../reference/add_access.html">add_access</a></span><span class="op">(</span><span class="op">)</span>,
            dataset <span class="op">=</span> <span class="va">dataset</span>,
            additionalMetadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>unitList <span class="op">=</span> <span class="va">unitList</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Once all of our information is appended to our eml list we can use the <code>write_eml</code> and <code>eml_validate</code> functions from the <code>EML</code> package to convert our list to EML and check validity.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">EML</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/EML/reference/write_eml.html">write_eml</a></span><span class="op">(</span><span class="va">eml</span>, <span class="st">"edi.750.1.xml"</span><span class="op">)</span>
<span class="fu">EML</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/EML/reference/eml_validate.html">eml_validate</a></span><span class="op">(</span><span class="st">"edi.750.1.xml"</span><span class="op">)</span></code></pre></div>
</div>
<div id="evaluation-using-the-edi-congruency-checker" class="section level2">
<h2 class="hasAnchor">
<a href="#evaluation-using-the-edi-congruency-checker" class="anchor"></a>Evaluation using the EDI Congruency Checker</h2>
<p>To evaluate your document in R using the EDI congruence checker you can use <code><a href="../reference/evaluate_edi_package.html">evaluate_edi_package()</a></code>. To use this function you must have the data table accessible by a URL that can be accessed through the EDI repository. This URL must be added in the <code>datatable_metadata</code> section above. If you do not have a URL available then you can upload the EML document and the dataset on the <a href="https://portal.edirepository.org/nis/home.jsp">EDI data portal.</a></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/evaluate_edi_package.html">evaluate_edi_package</a></span><span class="op">(</span>user_id <span class="op">=</span> <span class="st">"Your User Id"</span>, password <span class="op">=</span> <span class="st">"Your password"</span>, eml_file_path <span class="op">=</span> <span class="st">"edi.750.1.xml"</span><span class="op">)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Sadie Gill, Elizabeth Shaw, Erin Cain.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
